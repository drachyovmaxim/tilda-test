function t_slidesInit(recid) {
  var el = $('#rec'+recid),
      windowWidth = $(window).width(),
      sliderItem = el.find('.t-slides__item'),
      totalSlides = sliderItem.length,
      firstSlide = sliderItem.filter(':first'),
      lastSlide = sliderItem.filter(':last'),
      sliderWidth = el.find('.t-slides__container').width(),
      sliderTransition = el.find('.t-slides__items-wrapper').attr('data-slider-transition'),
      isPreview = el.find('.t-slides__items-wrapper').attr('data-slider-is-preview'),
      pos = 1,
      sliderDoResize;

  firstSlide.before(lastSlide.clone(true).attr('data-slide-index', '0')); 
  lastSlide.after(firstSlide.clone(true).attr('data-slide-index', totalSlides+1).removeClass('t-slides__item_active'));

  t_slides_setSliderWidth(recid);
  t_slides_setSliderHeight(recid);
  t_slides_slideMove(recid, pos, false);
  el.find('.t-slides').css('visibility', '')

  el.find('.t-slides__arrow_wrapper-right').click(function(){
    if (!$(this).is('.t-slides__arrow-clicked')) {
      $(this).addClass('t-slides__arrow-clicked');
      slideRight();
    }
  });

  el.find('.t-slides__arrow_wrapper-left').click(function(){
    if (!$(this).is('.t-slides__arrow-clicked')) {
      $(this).addClass('t-slides__arrow-clicked');
      slideLeft();
    }
  });

  if (isPreview !== 'true') {
    delete Hammer.defaults.cssProps.userSelect;
    hammer = new Hammer( el.find('.t-slides__items-wrapper')[ 0 ], {
      domEvents: true,
      threshold: 0,
      direction: Hammer.DIRECTION_VERTICAL
    } );
    hammer.on('pan', function(event){
      if (980 > windowWidth) {
        var distance = event.deltaX,
            percentage = 100 / totalSlides * event.deltaX / $(window).innerWidth(),
            sensitivity = 20;

        t_slides_scrollImages(recid, (sliderWidth * pos) - distance);

        if( event.isFinal ) {
          if( event.velocityX > 1 ) {
            slideLeft();
          } else if( event.velocityX < -1 ) {
            slideRight();
          } else {
            if ( percentage <= -( sensitivity / totalSlides ) ) {
              slideRight();
            } else if ( percentage >= ( sensitivity / totalSlides ) ) {
              slideLeft();
            } else {
              t_slides_slideMove(recid, pos, true);
            }
          }
        }
      }
    });
  }

  el.find('.t-slides__bullet').click(function(){
    pos = $(this).attr('data-slide-bullet-for');
    t_slides_slideMove(recid, pos, true);
  });

  function slideRight() {
    pos++;
    t_slides_slideMove(recid, pos, true);
    if(pos==(totalSlides+1)){
      setTimeout(function(){
        pos = 1;
        t_slides_slideMove(recid, pos, false);
      }, sliderTransition);
    }
  }

  function slideLeft() {
    pos--;
    t_slides_slideMove(recid, pos, true);
    if(pos==0){
      setTimeout(function(){
        pos = totalSlides;
        t_slides_slideMove(recid, pos, false);
      }, sliderTransition);
    }
  }

  $(window).resize(function() {
    if (sliderDoResize) clearTimeout(sliderDoResize);
    sliderDoResize = setTimeout(function() {
      windowWidth = $(window).width();
      sliderWidth = el.find('.t-slides__container').width()
      t_slides_setSliderWidth(recid);
      t_slides_slideMove(recid, pos, false);
    }, 200);        
  });
}

function t_slides_slideMove(recid, pos, animated){
  var el = $('#rec'+recid),
      sliderWrapper = el.find('.t-slides__items-wrapper'),
      sliderWidth = el.find('.t-slides__container').width(),
      totalSlides = el.find('.t-slides__item').length-1,
      sliderTransition = el.find('.t-slides__items-wrapper').attr('data-slider-transition'),
      isPreview = sliderWrapper.attr('data-slider-is-preview');

  if (animated==true) {
    sliderWrapper.addClass('t-slides_animated');
    if (isPreview=='true') {
      sliderWrapper.css({left: '-' + (sliderWidth*pos) + 'px'});
    } else {
      sliderWrapper.css({transform: 'translate3d(-' + (sliderWidth*pos) + 'px, 0, 0)'});
    }
    setTimeout(function(){
      sliderWrapper.removeClass('t-slides_animated');
      el.find('.t-slides__arrow_wrapper').removeClass('t-slides__arrow-clicked');
    }, sliderTransition);
  } else {
    if (isPreview=='true') {
      sliderWrapper.css({left: '-' + (sliderWidth*pos) + 'px'});
    } else {
      sliderWrapper.css({transform: 'translate3d(-' + (sliderWidth*pos) + 'px, 0, 0)'});
    }
    el.find('.t-slides__arrow_wrapper').removeClass('t-slides__arrow-clicked');
  }

  t_slides_setActiveBullet(recid, pos);
  t_slides_setActiveSlide(recid, pos);
  t_slides_setSliderHeight(recid);
}

function t_slides_scrollImages(recid, distance) {
  var el = $('#rec'+recid),
      value = (distance < 0 ? "" : "-") + Math.abs(distance).toString();
  el.find(".t-slides__items-wrapper").css("transform", "translate3d(" + value + "px, 0, 0)");
}

function t_slides_setActiveBullet(recid, pos) {
  var el = $('#rec'+recid),
      bullet = el.find('.t-slides__bullet'),
      bulletActive = el.find('.t-slides__bullet[data-slide-bullet-for="' + pos + '"]');
  bullet.removeClass('t-slides__bullet_active');
  bulletActive.addClass('t-slides__bullet_active');
}

function t_slides_setActiveSlide(recid, pos) {
  var el = $('#rec'+recid),
      slide = el.find('.t-slides__item'),
      slideActive = el.find('.t-slides__item[data-slide-index="' + pos + '"]');
  slide.removeClass('t-slides__item_active');
  slideActive.addClass('t-slides__item_active');
}

function t_slides_setSliderWidth(recid){
  var el = $('#rec'+recid),
      sliderWidth = el.find('.t-slides__container').width(),
      totalSlides = el.find('.t-slides__item').length;
  el.find('.t-slides__items-wrapper').width(sliderWidth*totalSlides);
  el.find('.t-slides__item').width(sliderWidth);
}

function t_slides_setSliderHeight(recid) {
  var el = $('#rec'+recid);
  el.find('.t-slides__items-wrapper').height(el.find('.t-slides__item_active').height());
  el.find('.t-slides__arrow_wrapper').height(el.find('.t-slides__item_active').height());
}